# AI 웹소켓 서버 배포 가이드

## 1. 시스템 요구사항
- CUDA 지원 GPU (CUDA 11.8 이상)
- Docker & Docker Compose
- Nginx
- Jenkins (CI/CD)

## 2. Docker 관련 설정

### 2.1 Dockerfile 수정사항
- 베이스 이미지: pytorch/pytorch:2.2.0-cuda11.8-cudnn8-runtime
- 시스템 의존성 추가:
  * ffmpeg (오디오 처리)
  * libsm6, libxext6 (OpenCV 의존성)

### 2.2 docker-compose.yml 설정
- GPU 사용 설정 추가 필요:
  * deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: all
              capabilities: [gpu]

## 3. 환경 변수 설정
- JWT_SECRET: JWT 토큰 생성용 비밀키
- 기타 필요한 환경 변수들

## 4. 모델 파일
- best.pt 파일 위치: /app/fastapi/best.pt
- 모델 파일이 Docker 이미지에 포함되어 있는지 확인

## 5. 포트 설정
- FastAPI 서버: 18000
- Nginx 프록시 설정 필요

## 6. 주의사항
1. CUDA 버전 호환성 확인
2. GPU 메모리 사용량 모니터링
3. 모델 파일 크기 고려
4. 오디오 처리용 ffmpeg 설치 확인

## 7. 패키지 관련 주의사항

### 7.1 OpenCV (opencv-python)
- 리눅스 환경에서는 `opencv-python-headless` 사용 권장
- GUI 관련 의존성이 없어 컨테이너 환경에 더 적합
- 시스템 라이브러리 의존성 (libsm6, libxext6) 필요

### 7.2 PyTorch (torch)
- CUDA 지원이 필요한 경우 특정 버전 지정 필요
- 현재 설정: CUDA 11.8 지원 버전 사용
- CPU만 사용하는 경우 기본 버전으로도 가능

### 7.3 오디오 처리 (pydub)
- ffmpeg 시스템 라이브러리 필요
- Dockerfile에 ffmpeg 설치 명령어 포함 필요
- 오디오 파일 처리 시 메모리 사용량 주의

### 7.4 시스템 의존성 패키지
```dockerfile
RUN apt-get update && apt-get install -y \
    ffmpeg \
    libsm6 \
    libxext6 \
    && rm -rf /var/lib/apt/lists/*
```

## 8. 모니터링 포인트
- GPU 사용률
- 메모리 사용량
- API 응답 시간
- WebSocket 연결 상태

## 9. 백업 사항
- best.pt 모델 파일
- 환경 변수 설정
- Nginx 설정 파일 